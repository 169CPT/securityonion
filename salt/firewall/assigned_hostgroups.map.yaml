{% import_yaml 'firewall/portgroups.yaml' as portgroups %}
{% set portgroups = portgroups.firewall.aliases.ports %}

role:
  eval:
    hostgroups:
      dockernet:
        portgroups:
          - {{ portgroups.all }}
      master:
        portgroups:
          - {{ portgroups.wazuh_endpoint }}
          - {{ portgroups.playbook }}
          - {{ portgroups.mysql }}
          - {{ portgroups.navigator }}
          - {{ portgroups.kibana }}
          - {{ portgroups.redis }}
          - {{ portgroups.influxdb }}
          - {{ portgroups.fleet_api }}
          - {{ portgroups.cortex }}
          - {{ portgroups.elasticsearch_rest }}
          - {{ portgroups.elasticsearch_node }}
          - {{ portgroups.cortex_es_rest }}
          - {{ portgroups.cortex_es_node }}
      minion:
        portgroups:
          - {{ portgroups.acng }}
          - {{ portgroups.salt_master }}
          - {{ portgroups.docker_registry }}
          - {{ portgroups.osquery_8080 }}
          - {{ portgroups.influxdb }}
          - {{ portgroups.wazuh_minion }}
      sensor:
        portgroups:
          - {{ portgroups.sensoroni }}
          - {{ portgroups.beats_5044 }}
          - {{ portgroups.beats_5644 }}
      search_node:
        portgroups:
          - {{ portgroups.redis }}
          - {{ portgroups.elasticsearch_node }}
      beats_endpoint:
        portgroups:
          - {{ portgroups.beats_5044 }}
      osquery_endpoint:
        portgroups:
          - {{ portgroups.fleet_api }}
      wazuh_endpoint:
        portgroups:
          - {{ portgroups.wazuh_endpoint  }}
      analyst:
        portgroups:
          - {{ portgroups.nginx }}
  helixsensor:
    hostgroups:
      dockernet:
        portgroups:
          - {{ portgroups.all }}
      master:
        portgroups:
          - {{ portgroups.wazuh_endpoint }}
          - {{ portgroups.playbook }}
          - {{ portgroups.mysql }}
          - {{ portgroups.navigator }}
          - {{ portgroups.kibana }}
          - {{ portgroups.redis }}
          - {{ portgroups.influxdb }}
          - {{ portgroups.fleet_api }}
          - {{ portgroups.cortex }}
          - {{ portgroups.elasticsearch_rest }}
          - {{ portgroups.elasticsearch_node }}
          - {{ portgroups.cortex_es_rest }}
          - {{ portgroups.cortex_es_node }}
      minion:
        portgroups:
          - {{ portgroups.acng }}
          - {{ portgroups.salt_master }}
          - {{ portgroups.docker_registry }}
          - {{ portgroups.osquery_8080 }}
          - {{ portgroups.influxdb }}
          - {{ portgroups.wazuh_minion }}
      sensor:
        portgroups:
          - {{ portgroups.sensoroni }}
          - {{ portgroups.beats_5044 }}
          - {{ portgroups.beats_5644 }}
      search_node:
        portgroups:
          - {{ portgroups.redis }}
          - {{ portgroups.elasticsearch_node }}
      beats_endpoint:
        portgroups:
          - {{ portgroups.beats_5044 }}
      osquery_endpoint:
        portgroups:
          - {{ portgroups.fleet_api }}
      wazuh_endpoint:
        portgroups:
          - {{ portgroups.wazuh_endpoint  }}
      analyst:
        portgroups:
          - {{ portgroups.nginx }}
  master:
    hostgroups:
      dockernet:
        portgroups:
          - {{ portgroups.all }}
      master:
        portgroups:
          - {{ portgroups.wazuh_endpoint }}
          - {{ portgroups.playbook }}
          - {{ portgroups.mysql }}
          - {{ portgroups.navigator }}
          - {{ portgroups.kibana }}
          - {{ portgroups.redis }}
          - {{ portgroups.influxdb }}
          - {{ portgroups.fleet_api }}
          - {{ portgroups.cortex }}
          - {{ portgroups.elasticsearch_rest }}
          - {{ portgroups.elasticsearch_node }}
          - {{ portgroups.cortex_es_rest }}
          - {{ portgroups.cortex_es_node }}
      minion:
        portgroups:
          - {{ portgroups.acng }}
          - {{ portgroups.salt_master }}
          - {{ portgroups.docker_registry }}
          - {{ portgroups.osquery_8080 }}
          - {{ portgroups.influxdb }}
          - {{ portgroups.wazuh_minion }}
      sensor:
        portgroups:
          - {{ portgroups.sensoroni }}
          - {{ portgroups.beats_5044 }}
          - {{ portgroups.beats_5644 }}
      search_node:
        portgroups:
          - {{ portgroups.redis }}
          - {{ portgroups.elasticsearch_node }}
      beats_endpoint:
        portgroups:
          - {{ portgroups.beats_5044 }}
      osquery_endpoint:
        portgroups:
            - {{ portgroups.fleet_api }}
      wazuh_endpoint:
        portgroups:
          - {{ portgroups.wazuh_endpoint  }}
      analyst:
        portgroups:
          - {{ portgroups.nginx }}
  mastersearch:
    hostgroups:
      dockernet:
        portgroups:
          - {{ portgroups.all }}
      master:
        portgroups:
          - {{ portgroups.wazuh_endpoint }}
          - {{ portgroups.playbook }}
          - {{ portgroups.mysql }}
          - {{ portgroups.navigator }}
          - {{ portgroups.kibana }}
          - {{ portgroups.redis }}
          - {{ portgroups.influxdb }}
          - {{ portgroups.fleet_api }}
          - {{ portgroups.cortex }}
          - {{ portgroups.elasticsearch_rest }}
          - {{ portgroups.elasticsearch_node }}
          - {{ portgroups.cortex_es_rest }}
          - {{ portgroups.cortex_es_node }}
      minion:
        portgroups:
          - {{ portgroups.acng }}
          - {{ portgroups.salt_master }}
          - {{ portgroups.docker_registry }}
          - {{ portgroups.osquery_8080 }}
          - {{ portgroups.influxdb }}
          - {{ portgroups.wazuh_minion }}
      sensor:
        portgroups:
          - {{ portgroups.sensoroni }}
          - {{ portgroups.beats_5044 }}
          - {{ portgroups.beats_5644 }}
      search_node:
        portgroups:
          - {{ portgroups.redis }}
          - {{ portgroups.elasticsearch_node }}
      beats_endpoint:
        portgroups:
          - {{ portgroups.beats_5044 }}
      osquery_endpoint:
        portgroups:
          - {{ portgroups.fleet_api }}
      wazuh_endpoint:
        portgroups:
          - {{ portgroups.wazuh_endpoint  }}
      analyst:
        portgroups:
          - {{ portgroups.nginx }}
  standalone:
    hostgroups:
      dockernet:
        portgroups:
          - {{ portgroups.all }}
      master:
        portgroups:
          - {{ portgroups.wazuh_endpoint }}
          - {{ portgroups.playbook }}
          - {{ portgroups.mysql }}
          - {{ portgroups.navigator }}
          - {{ portgroups.kibana }}
          - {{ portgroups.redis }}
          - {{ portgroups.influxdb }}
          - {{ portgroups.fleet_api }}
          - {{ portgroups.cortex }}
          - {{ portgroups.elasticsearch_rest }}
          - {{ portgroups.elasticsearch_node }}
          - {{ portgroups.cortex_es_rest }}
          - {{ portgroups.cortex_es_node }}
      minion:
        portgroups:
          - {{ portgroups.acng }}
          - {{ portgroups.salt_master }}
          - {{ portgroups.docker_registry }}
          - {{ portgroups.osquery_8080 }}
          - {{ portgroups.influxdb }}
          - {{ portgroups.wazuh_minion }}
      sensor:
        portgroups:
          - {{ portgroups.sensoroni }}
          - {{ portgroups.beats_5044 }}
          - {{ portgroups.beats_5644 }}
      search_node:
        portgroups:
          - {{ portgroups.redis }}
          - {{ portgroups.elasticsearch_node }}
      beats_endpoint:
        portgroups:
          - {{ portgroups.beats_5044 }}
      osquery_endpoint:
        portgroups:
          - {{ portgroups.fleet_api }}
      wazuh_endpoint:
        portgroups:
          - {{ portgroups.wazuh_endpoint  }}
      analyst:
        portgroups:
          - {{ portgroups.nginx }}
  searchnode:
    hostgroups:
      master:
        portgroups:
          - {{ portgroups.elasticsearch_node }}
      dockernet:
        portgroups:
          - {{ portgroups.all }}
          - {{ portgroups.elasticsearch_node }}
          - {{ portgroups.elasticsearch_node }}
  sensor:
    hostgroups:
      dockernet:
        portgroups:
          - {{ portgroups.all }}
  heavynode:
    hostgroups:
      self:
        portgroups:
          - {{ portgroups.redis }}
          - {{ portgroups.beats_5044 }}
          - {{ portgroups.beats_5644 }}
  fleet:
    hostgroups:
      dockernet:
        portgroups:
          - {{ portgroups.all }}
      self:
        portgroups:
          - {{ portgroups.redis }}
          - {{ portgroups.mysql }}
          - {{ portgroups.osquery_8080 }}
      localhost:
        portgroups:
          - {{ portgroups.mysql }}
          - {{ portgroups.osquery_8080 }}
      analyst:
        portgroups:
          - {{ portgroups.fleet_webui }}