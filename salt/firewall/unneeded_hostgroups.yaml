{% import_yaml 'firewall/port_groups.yaml' as port_groups %}
{% set port_groups = port_groups.firewall.aliases.ports %}

firewall:
  aliases:
    analyst:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.nginx }}
    beats_endpoint:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.beats_5044 }}
    fleet:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.mysql }}
        - {{ port_groups.redis }}
        - {{ port_groups.osquery_8080 }}
    heavy_node:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.redis }}
        - {{ port_groups.beats_5044 }}
        - {{ port_groups.beats_5644 }}
    master:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.wazuh_endpoint }}
        - {{ port_groups.playbook }}
        - {{ port_groups.mysql }}
        - {{ port_groups.navigator }}
        - {{ port_groups.kibana }}
        - {{ port_groups.redis }}
        - {{ port_groups.influxdb }}
        - {{ port_groups.osquery_8090 }}
        - {{ port_groups.cortex }}
        - {{ port_groups.elasticsearch_rest }}
        - {{ port_groups.elasticsearch_node }}
        - {{ port_groups.cortex_es_rest }}
        - {{ port_groups.cortex_es_node }}
    minion:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.acng }}
        - {{ port_groups.salt_master }}
        - {{ port_groups.docker_registry }}
        - {{ port_groups.osquery_8080 }}
        - {{ port_groups.influxdb }}
        - {{ port_groups.wazuh_minion }}
    node:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.elasticsearch_node }}
    osquery_endpoint:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.osquery_8090 }}
    search_node:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.redis }}
        - {{ port_groups.elasticsearch_node }}
    sensor:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.sensoroni }}
        - {{ port_groups.beats_5044 }}
        - {{ port_groups.beats_5644 }}
    wazuh_endpoint:
      ips:
        delete:
        insert:
      port_groups:
        - {{ port_groups.wazuh_endpoint }}